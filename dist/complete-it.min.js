!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.CompleteIt=t()}}(function(){return function t(e,i,n){function s(o,u){if(!i[o]){if(!e[o]){var h="function"==typeof require&&require;if(!u&&h)return h(o,!0);if(r)return r(o,!0);var a=new Error("Cannot find module '"+o+"'");throw a.code="MODULE_NOT_FOUND",a}var l=i[o]={exports:{}};e[o][0].call(l.exports,function(t){var i=e[o][1][t];return s(i?i:t)},l,l.exports,t,e,i,n)}return i[o].exports}for(var r="function"==typeof require&&require,o=0;o<n.length;o++)s(n[o]);return s}({1:[function(t,e,i){"use strict";var n;n="undefined"!=typeof _?_.throttle:t("lodash.throttle");var s={$listElements:[],queries:!1,elements:[],input:"",cachedInput:"",currentIndex:0,submitPrevented:!0,UPARROWKEY:38,DOWNARROWKEY:40,ENTERKEY:13,ESCKEY:27,RIGHTARROWKEY:39,HASHPREFIX:"completeit_",init:function(t,e){this.$element=t,this.$input=t.querySelector("input[type=text]"),this.$list=document.createElement("ul"),this.$list.classList.add("list"),this.$ghostInput=this.$input.cloneNode(!0),this.$ghostInput.classList.add("ghost-input"),this.$ghostInput.setAttribute("disabled",!0),this.$ghostInput.setAttribute("placeholder","");var i={throttleTime:500,minLength:5,middleware:function(t,e){return console.log(e),t},ajax:function(t){return console.log(t),new Promise},cache:"localStorage",cacheExpires:604800};e=e?e:{},this.options=this.utils.extend(i,e),this.$input&&(this.$element.appendChild(this.$list),this.$element.appendChild(this.$ghostInput),this.$element.classList.add("complete-it"),this.initCache(),this.bindEvents())},initCache:function(){"localStorage"===this.options.cache?(this.storageSupport=this.supportsStorage("localStorage"),this.initStorage(localStorage)):"sessionStorage"===this.options.cache?(this.storageSupport=this.supportsStorage("sessionStorage"),this.initStorage(sessionStorage)):"memory"===this.options.cache&&(this.queries=[])},initStorage:function(t){this.storageSupport?(this.cleanStorage(t),this.queries=t):this.queries=[]},cleanStorage:function(t){for(var e=[],i=0;i<t.length;i++){var n=t.key(i);if(n.indexOf(this.HASHPREFIX)>-1){var s=JSON.parse(t.getItem(n));Math.floor(Date.now()/1e3)-s.createdAt>this.options.cacheExpires&&e.push(n)}}for(var r=0;r<e.length;r++)t.removeItem(e[r])},updateQueries:function(){if(this.queries){var t=this.utils.indexer(this.input,this);if(this.queries[t])console.warn("Error: this query is already present: "+t);else{var e={query:this.input,elements:this.elements};this.queries[t]=this.storeQuery(e)}}},storeQuery:function(t){return this.storageSupport&&(t.createdAt=Math.floor(Date.now()/1e3),t=JSON.stringify(t)),t},parseElements:function(t){return this.storageSupport?JSON.parse(t).elements:t.elements},supportsStorage:function(t){try{return t in window&&null!==window[t]}catch(e){return!1}},ajaxCallback:function(t){var e=this.options.middleware(t,this.input);e=this.formatElements(e),this.elements=e,this.updateQueries(),this.updateDom()},performQuery:function(){var t=this.options.ajax(this.input);t.then(this.utils.bind(this.ajaxCallback,this))},formatElements:function(t){for(var e=0;e<t.length;e++){var i=t[e];i.content&&(i.formattedContent=i.content.toLowerCase().replace(/[^a-zA-Z ]/g,""),i.formattedContent.indexOf(this.input)>-1&&(i.formattedContent=i.formattedContent.replace(this.input,"<span>"+this.input+"</span>")));for(var n in i)"content"!==n&&"formattedContent"!==n&&delete i[n]}return t},keydownProxy:function(t){t.stopPropagation(),t.which===this.UPARROWKEY||t.which===this.DOWNARROWKEY?this.keydownArrows(t):t.which===this.ENTERKEY?this.select(!0):t.which===this.ESCKEY?this.keydownEsc(t):t.which===this.RIGHTARROWKEY?this.keydownRightArrow(t):this.keydownOther(t)},keydownOther:function(){var t=this.$input.value;if(this.updateGhostInput(t),this.input=t.trim().toLowerCase(),this.input.length>=this.options.minLength){this.cachedInput=t;var e=this.queries?this.queries[this.utils.indexer(this.input,this)]:!1;if(e)this.elements=this.parseElements(e),this.updateDom();else{var i=new Event("performQuery");this.$element.dispatchEvent(i)}}},keydownEsc:function(){this.unselect()},keydownRightArrow:function(t){this.$ghostInput.value.length>0&&this.elements.length&&this.$ghostInput.value===this.elements[0].content&&(t.preventDefault(),this.currentIndex=0,this.select(),this.updateCurrentElementInDOM())},keydownArrows:function(t){var e,i=t.which===this.UPARROWKEY?-1:1;e=this.currentIndex+i,e>=0&&e<=this.elements.length-1?(this.currentIndex=e,this.updateCurrentElementInDOM(),this.select()):this.unselect()},selectByHover:function(t){if(t.target&&"LI"===t.target.nodeName){var e=t.target,i=this.utils.elementIndex(e);this.currentIndex=i,this.updateCurrentElementInDOM()}},selectByClick:function(t){t.target&&"LI"===t.target.nodeName&&(this.selectByHover(t),this.select(!0))},updateCurrentElementInDOM:function(){for(var t=0;t<this.$listElements.length;t++)t===this.currentIndex?this.$listElements[t].classList.add("current"):this.$listElements[t].classList.remove("current")},updateDom:function(){for(this.currentIndex=-1,this.$list.classList.remove("open");this.$list.firstChild;)this.$list.removeChild(this.$list.firstChild);for(var t=0;t<this.elements.length;t++){var e=document.createElement("li");e.innerHTML=this.elements[t].formattedContent,this.$list.appendChild(e)}this.$list.classList.add("open"),this.$listElements=this.$list.querySelectorAll("li"),this.ghostInputApparition()},updateGhostInput:function(t){this.$ghostInput.value=t},ghostInputApparition:function(){if(this.elements.length){var t=this.elements[0].content;t&&0===t.indexOf(this.cachedInput)&&this.updateGhostInput(t)}},select:function(t){if(this.currentIndex>-1){-1===this.$list.className.indexOf("open")&&this.$list.classList.add("open");var e=this.elements[this.currentIndex];this.$input.value=e.content,this.updateGhostInput("")}t&&(this.submitPrevented=!1,this.$element.submit())},unselect:function(){this.$list.classList.remove("open"),this.unselectIndex(),this.$input.value=this.cachedInput},unselectIndex:function(){this.currentIndex=-1,this.updateCurrentElementInDOM()},submitHandler:function(t){this.submitPrevented&&t.preventDefault()},bindEvents:function(){this.$element.addEventListener("performQuery",n(this.utils.bind(this.performQuery,this),this.options.throttleTime,{leading:!0,trailing:!0})),this.$element.addEventListener("keyup",this.utils.bind(this.keydownProxy,this)),this.$element.addEventListener("submit",this.utils.bind(this.submitHandler,this)),this.$list.addEventListener("click",this.utils.bind(this.selectByClick,this)),this.$list.addEventListener("mouseover",this.utils.bind(this.selectByHover,this)),this.$list.addEventListener("mouseout",this.utils.bind(this.unselectIndex,this))},utils:{bind:function(t,e){return function(){t.apply(e,arguments)}},extend:function(){var t={};for(var e in arguments){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},elementIndex:function(t){for(var e=0;null!==t.previousSibling;)e++,t=t.previousSibling;return e},indexer:function(t,e){var i,n,s=0,r=t.length;for(i=0,r;r>i;i++)n=t.charCodeAt(i),s=(s<<5)-s+n,s|=0;return e.HASHPREFIX+s}}};e.exports=s},{"lodash.throttle":2}],2:[function(t,e,i){function n(t,e,i){var n=!0,u=!0;if("function"!=typeof t)throw new TypeError(o);return i===!1?n=!1:s(i)&&(n="leading"in i?!!i.leading:n,u="trailing"in i?!!i.trailing:u),r(t,e,{leading:n,maxWait:+e,trailing:u})}function s(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}var r=t("lodash.debounce"),o="Expected a function";e.exports=n},{"lodash.debounce":3}],3:[function(t,e,i){function n(t,e,i){function n(){g&&clearTimeout(g),d&&clearTimeout(d),E=0,d=g=y=void 0}function r(e,i){i&&clearTimeout(i),d=g=y=void 0,e&&(E=a(),f=t.apply(v,p),g||d||(p=v=void 0))}function h(){var t=e-(a()-m);0>=t||t>e?r(y,d):g=setTimeout(h,t)}function l(){r($,g)}function c(){if(p=arguments,m=a(),v=this,y=$&&(g||!w),x===!1)var i=w&&!g;else{d||w||(E=m);var n=x-(m-E),s=0>=n||n>x;s?(d&&(d=clearTimeout(d)),E=m,f=t.apply(v,p)):d||(d=setTimeout(l,n))}return s&&g?g=clearTimeout(g):g||e===x||(g=setTimeout(h,e)),i&&(s=!0,f=t.apply(v,p)),!s||g||d||(p=v=void 0),f}var p,d,f,m,v,g,y,E=0,x=!1,$=!0;if("function"!=typeof t)throw new TypeError(o);if(e=0>e?0:+e||0,i===!0){var w=!0;$=!1}else s(i)&&(w=!!i.leading,x="maxWait"in i&&u(+i.maxWait||0,e),$="trailing"in i?!!i.trailing:$);return c.cancel=n,c}function s(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}var r=t("lodash._getnative"),o="Expected a function",u=Math.max,h=r(Date,"now"),a=h||function(){return(new Date).getTime()};e.exports=n},{"lodash._getnative":4}],4:[function(t,e,i){function n(t){return!!t&&"object"==typeof t}function s(t,e){var i=null==t?void 0:t[e];return u(i)?i:void 0}function r(t){return o(t)&&d.call(t)==h}function o(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function u(t){return null==t?!1:r(t)?f.test(c.call(t)):n(t)&&a.test(t)}var h="[object Function]",a=/^\[object .+?Constructor\]$/,l=Object.prototype,c=Function.prototype.toString,p=l.hasOwnProperty,d=l.toString,f=RegExp("^"+c.call(p).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=s},{}]},{},[1])(1)});
